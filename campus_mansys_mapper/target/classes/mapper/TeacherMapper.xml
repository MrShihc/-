<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.campus.mapper.TeacherMapper">

    <!-- 查询出当前登录人发布的实体 -->
    <select id="getDuliTestList" resultType="TestBean">
        SELECT
            DISTINCT t.*
        FROM
            tb_test t
            LEFT JOIN tb_test_grade tg ON t.testid = tg.testid
            LEFT JOIN tb_grade g ON tg.gid = g.gid
            left join tb_teacher_grade teacherg on g.gid = teacherg.gid where teacherg.tid=#{tid}

    </select>

    <!-- 根据当前老师id，查询出该老师发布的班级信息 -->
    <select id="getCurLoginPeoGrade" resultType="Grade">
        select * from tb_grade g left join tb_teacher_grade tg on g.gid=tg.gid where tg.tid= #{tid} order by gname asc
    </select>

    <!-- 判断考卷名称的唯一性 -->
    <select id="uniTestname" resultType="TestBean">
        SELECT * FROM tb_test WHERE testname = #{testname}
    </select>

    <!-- 添加考卷信息 -->
    <insert id="saveTestInfo" useGeneratedKeys="true" keyProperty="testid" keyColumn="testid">
<!--    <selectKey keyProperty="testid" keyColumn="testid" order="BEFORE"></selectKey>-->
        INSERT INTO `tb_test`(`testname`, `totalscore`, `passscore`, `testtime`, `starttime`, `endtime`, `updatetime`, `testauthor`, `authorid`)
        VALUES (#{testname},#{totalscore},#{passscore},#{testtime},#{starttime},#{endtime},#{updatetime},#{testauthor},#{authorid})
    </insert>
</mapper>